<!DOCTYPE html>
<html lang="pt-PT">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ISO 9001:2015 - REVIMAQ</title>
  
  <!-- Estilos e Bibliotecas Externa -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/@phosphor-icons/web"></script>
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Configuração Firebase -->
  <script type="importmap">
    {
      "imports": {
        "firebase/app": "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js",
        "firebase/auth": "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js",
        "firebase/firestore": "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js"
      }
    }
  </script>
  <script type="module">
    import { initializeApp } from 'firebase/app';
    import { getAuth, signInAnonymously, onAuthStateChanged } from 'firebase/auth';
    import { getFirestore, collection, onSnapshot, addDoc, updateDoc, doc, deleteDoc } from 'firebase/firestore';
    
    // Tornar as funções do Firebase acessíveis globalmente para o React
    window.firebaseAPI = { 
        initializeApp, 
        getAuth,
        signInAnonymously,
        onAuthStateChanged,
        getFirestore, 
        collection, 
        onSnapshot, 
        addDoc, 
        updateDoc, 
        doc,
        deleteDoc
    };
  </script>

  <style>
    * { text-transform: uppercase !important; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-fade-in { animation: fadeIn 0.4s ease-out forwards; }
    
    @media print {
      body { background-color: white !important; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      .no-print { display: none !important; }
      .print-area { display: block !important; width: 100% !important; margin: 0 !important; padding: 0 !important; box-shadow: none !important; }
      @page { margin: 1cm; size: A4 portrait; }
    }

    input::placeholder, textarea::placeholder { text-transform: uppercase !important; }
  </style>
</head>
<body class="bg-slate-100/50 font-sans uppercase">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    function App() {
      // ESTADOS DE NAVEGAÇÃO E DADOS
      const [currentView, setCurrentView] = useState('dashboard');
      const [isEditing, setIsEditing] = useState(false);
      const [isLoading, setIsLoading] = useState(true);
      const [showAllRecords, setShowAllRecords] = useState(false); 
      const [searchTerm, setSearchTerm] = useState('');
      const [printData, setPrintData] = useState(null);
      const [previousView, setPreviousView] = useState('dashboard');
      const [records, setRecords] = useState([]);
      
      // ESTADO DO FIREBASE
      const [user, setUser] = useState(null);

      // ESTADOS DE SEGURANÇA DA RNC
      const [isRncLocked, setIsRncLocked] = useState(false);

      // ESTADOS DOS DROPDOWNS
      const [clientes, setClientes] = useState([]);
      const [emitentes, setEmitentes] = useState([]);
      const [areas, setAreas] = useState([]);
      const [processos, setProcessos] = useState([]);
      const [titulos, setTitulos] = useState([]);
      const [responsaveis, setResponsaveis] = useState([]);

      const dbRef = useRef(null);
      const appId = "gestao-de-pessoas-49200";

      const firebaseConfig = {
        apiKey: "AIzaSyBqV0KOQMAYR4z6P_RKnrQPDfkAR2CsXBI",
        authDomain: "gestao-de-pessoas-49200.firebaseapp.com",
        projectId: "gestao-de-pessoas-49200",
        storageBucket: "gestao-de-pessoas-49200.firebasestorage.app",
        messagingSenderId: "615097388185",
        appId: "1:615097388185:web:d7f50a26e00f14bcf23c08"
      };

      // INICIALIZAÇÃO FIREBASE COM AUTH (REGRA 3)
      useEffect(() => {
        const initFirebase = async () => {
          if (window.firebaseAPI) {
            const { initializeApp, getFirestore, getAuth, signInAnonymously, onAuthStateChanged } = window.firebaseAPI;
            try {
              const app = initializeApp(firebaseConfig);
              dbRef.current = getFirestore(app);
              const auth = getAuth(app);
              
              await signInAnonymously(auth);
              onAuthStateChanged(auth, (u) => {
                setUser(u);
              });
            } catch (err) {
              console.error("ERRO INICIALIZAÇÃO:", err);
            }
          }
        };
        initFirebase();
      }, []);

      // CARREGAMENTO DE DADOS (REGRA 1 - PATHS RESTRITOS)
      useEffect(() => {
        if (!user || !dbRef.current) return;

        const { collection, onSnapshot } = window.firebaseAPI;
        
        // Função auxiliar para simplificar os caminhos obrigatórios
        const getCol = (name) => collection(dbRef.current, 'artifacts', appId, 'public', 'data', name);

        const unsubOcorrencias = onSnapshot(getCol("ocorrencias"), (snapshot) => {
          const loadedRecords = snapshot.docs.map(doc => ({ idDb: doc.id, ...doc.data() }));
          loadedRecords.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
          setRecords(loadedRecords);
          setIsLoading(false);
        }, (error) => {
          console.error("ERRO FIREBASE:", error);
          setIsLoading(false);
        });

        const unsubClientes = onSnapshot(getCol("clientes"), (s) => setClientes(s.docs.map(d => ({ id: d.id, nome: d.data().nome }))));
        const unsubEmitentes = onSnapshot(getCol("emitentes"), (s) => setEmitentes(s.docs.map(d => ({ id: d.id, nome: d.data().nome }))));
        const unsubAreas = onSnapshot(getCol("areas"), (s) => setAreas(s.docs.map(d => ({ id: d.id, nome: d.data().nome }))));
        const unsubProcessos = onSnapshot(getCol("processos"), (s) => setProcessos(s.docs.map(d => ({ id: d.id, nome: d.data().nome }))));
        const unsubTitulos = onSnapshot(getCol("titulos"), (s) => setTitulos(s.docs.map(d => ({ id: d.id, nome: d.data().nome }))));
        const unsubResponsaveis = onSnapshot(getCol("responsaveis"), (s) => setResponsaveis(s.docs.map(d => ({ id: d.id, nome: d.data().nome }))));

        return () => {
          unsubOcorrencias(); unsubClientes(); unsubEmitentes(); unsubAreas(); unsubProcessos(); unsubTitulos(); unsubResponsaveis();
        };
      }, [user]);

      const initialState = {
        id: '', rncId: '', dataOcorrencia: new Date().toISOString().split('T')[0],
        origem: 'PROCESSO INTERNO', referencia: '', cliente: '', processo: '', area: '', produto: '',
        titulo: '', descricao: '', efeito: '', procedente: '', disposicao: '', acaoImediata: '',
        respDisposicao: '', custo: '', prazo: '', evidencias: '', anexos: '', necessitaRNC: 'NÃO AVALIADO',
        analiseSaida: '', status: 'ABERTO', dataEncerramento: '', emitidoPor: '', email: '',
        rncRiscoPotencial: 'NÃO', rncAtualizarRiscos: 'NÃO', rncResponsavelRiscos: '', rncDataRiscos: '',
        rncMetodo: '', rncMaquina: '', rncMedida: '', rncMeioAmbiente: '', rncMaoDeObra: '',
        rncMaterial: '', rncCausaRaiz: '', rncAcaoCorretiva: '', rncResponsavelAcao: '',
        rncPrevisao: '', rncRealizado: '', rncStatusAcao: 'PENDENTE'
      };

      const [formData, setFormData] = useState(initialState);

      const handleEdit = (record) => {
        setFormData({ ...initialState, ...record });
        setIsEditing(true);
        setIsRncLocked((record.necessitaRNC || '').toUpperCase() === 'SIM');
        setCurrentView('form');
        window.scrollTo({ top: 0, behavior: 'smooth' });
      };

      const handlePrint = (record, sourceView) => {
        setPrintData(record);
        setPreviousView(sourceView);
        setCurrentView('print');
        window.scrollTo({ top: 0, behavior: 'instant' });
      };

      const handleInputChange = (e) => {
        const { name, value } = e.target;
        setFormData({ ...formData, [name]: value.toUpperCase() });
      };

      // ----------------------------------------------------
      // FUNÇÕES DO BANCO DE DADOS (ATUALIZADAS COM PATHS)
      // ----------------------------------------------------
      const handleAddGeneric = async (collectionName, field, promptMsg) => {
        const val = window.prompt(promptMsg);
        if (val && val.trim() !== "") {
          const name = val.trim().toUpperCase();
          const { collection, addDoc } = window.firebaseAPI;
          try {
            await addDoc(collection(dbRef.current, 'artifacts', appId, 'public', 'data', collectionName), { nome: name });
            setFormData(prev => ({ ...prev, [field]: name }));
          } catch (e) { console.error(e); }
        }
      };

      const handleEditGeneric = async (collectionName, field, list, currentVal, promptMsg) => {
        if (!currentVal) return alert("SELECIONE UM ITEM.");
        const val = window.prompt(promptMsg, currentVal);
        if (val && val.trim() !== "") {
          const name = val.trim().toUpperCase();
          const item = list.find(i => i.nome === currentVal);
          if (item) {
            const { doc, updateDoc } = window.firebaseAPI;
            try {
              await updateDoc(doc(dbRef.current, 'artifacts', appId, 'public', 'data', collectionName, item.id), { nome: name });
              setFormData(prev => ({ ...prev, [field]: name }));
            } catch (e) { console.error(e); }
          }
        }
      };

      const handleAddCliente = () => handleAddGeneric("clientes", "cliente", "NOME DO CLIENTE:");
      const handleEditCliente = () => handleEditGeneric("clientes", "cliente", clientes, formData.cliente, "EDITAR CLIENTE:");
      const handleAddEmitente = () => handleAddGeneric("emitentes", "emitidoPor", "NOME DO EMITENTE:");
      const handleEditEmitente = () => handleEditGeneric("emitentes", "emitidoPor", emitentes, formData.emitidoPor, "EDITAR EMITENTE:");
      const handleAddArea = () => handleAddGeneric("areas", "area", "NOME DA ÁREA:");
      const handleEditArea = () => handleEditGeneric("areas", "area", areas, formData.area, "EDITAR ÁREA:");
      const handleAddProcesso = () => handleAddGeneric("processos", "processo", "NOME DO PROCESSO:");
      const handleEditProcesso = () => handleEditGeneric("processos", "processo", processos, formData.processo, "EDITAR PROCESSO:");
      const handleAddTitulo = () => handleAddGeneric("titulos", "titulo", "TÍTULO RESUMIDO:");
      const handleEditTitulo = () => handleEditGeneric("titulos", "titulo", titulos, formData.titulo, "EDITAR TÍTULO:");
      const handleAddResponsavel = () => handleAddGeneric("responsaveis", "respDisposicao", "NOME DO RESPONSÁVEL:");
      const handleEditResponsavel = () => handleEditGeneric("responsaveis", "respDisposicao", responsaveis, formData.respDisposicao, "EDITAR RESPONSÁVEL:");
      const handleAddResponsavelAcao = () => handleAddGeneric("responsaveis", "rncResponsavelAcao", "NOME DO RESPONSÁVEL (AÇÃO):");
      const handleEditResponsavelAcao = () => handleEditGeneric("responsaveis", "rncResponsavelAcao", responsaveis, formData.rncResponsavelAcao, "EDITAR RESPONSÁVEL:");

      const copyToCausaRaiz = (fieldName, label) => {
        const text = formData[fieldName];
        if (!text) return;
        const entry = `${label.replace(/[0-9]+\.\s*/g, '')}: ${text}`;
        setFormData(prev => {
          const current = prev.rncCausaRaiz || '';
          if (current.includes(entry)) return prev;
          return { ...prev, rncCausaRaiz: current ? `${current}\n${entry}` : entry };
        });
      };

      const generateNewId = (prefix) => {
        const year = new Date().getFullYear();
        const yearPrefix = `${prefix}-${year}-`;
        const ids = records.map(r => prefix === 'RO' ? r.id : r.rncId).filter(id => id && id.startsWith(yearPrefix));
        if (ids.length === 0) return `${yearPrefix}001`;
        const numbers = ids.map(id => parseInt(id.split('-').pop(), 10) || 0);
        return `${yearPrefix}${(Math.max(...numbers) + 1).toString().padStart(3, '0')}`;
      };

      const handleSubmit = async (e) => {
        e.preventDefault();
        if (!user) return alert("SISTEMA NÃO AUTENTICADO.");
        const { collection, addDoc, updateDoc, doc } = window.firebaseAPI;
        let data = { ...formData };
        try {
          if (isEditing) {
            if (data.necessitaRNC === 'SIM' && !data.rncId) data.rncId = generateNewId('RNC');
            else if (data.necessitaRNC !== 'SIM') data.rncId = '';
            const ref = doc(dbRef.current, 'artifacts', appId, 'public', 'data', 'ocorrencias', formData.idDb);
            const toUpdate = { ...data, updatedAt: new Date().toISOString() };
            delete toUpdate.idDb;
            await updateDoc(ref, toUpdate);
          } else {
            const roId = generateNewId('RO');
            const rncId = data.necessitaRNC === 'SIM' ? generateNewId('RNC') : '';
            await addDoc(collection(dbRef.current, 'artifacts', appId, 'public', 'data', 'ocorrencias'), { ...data, id: roId, rncId, timestamp: new Date().toISOString() });
          }
          setCurrentView('list');
          setFormData(initialState);
          setIsEditing(false);
          setIsRncLocked(false);
        } catch (error) { console.error(error); alert("ERRO AO SALVAR."); }
      };

      const filteredRecords = records.filter(record => {
        const term = searchTerm.toLowerCase();
        const matchesSearch = (record.id || '').toLowerCase().includes(term) || (record.titulo || '').toLowerCase().includes(term) || (record.area || '').toLowerCase().includes(term);
        const matchesStatus = showAllRecords ? true : (record.status !== 'ENCERRADO' || record.necessitaRNC === 'NÃO AVALIADO');
        return matchesSearch && matchesStatus;
      });

      const stats = {
        total: records.length,
        open: records.filter(r => r.status === 'ABERTO').length,
        inProgress: records.filter(r => r.status === 'EM TRATAMENTO').length,
        closed: records.filter(r => r.status === 'ENCERRADO').length,
        needsRNC: records.filter(r => r.necessitaRNC === 'SIM').length
      };

      const getStatusColor = (status) => {
        const s = (status || '').toUpperCase();
        if (s === 'ABERTO') return 'bg-red-100 text-red-800 border-red-200';
        if (s === 'EM TRATAMENTO') return 'bg-yellow-100 text-yellow-800 border-yellow-200';
        if (s === 'ENCERRADO') return 'bg-green-100 text-green-800 border-green-200';
        return 'bg-slate-100 text-slate-800 border-slate-200';
      };

      const getRNCStatusColor = (status) => {
        const s = (status || '').toUpperCase();
        if (s === 'PENDENTE') return 'bg-slate-100 text-slate-800 border-slate-200';
        if (s === 'EM ANDAMENTO') return 'bg-yellow-100 text-yellow-800 border-yellow-200';
        if (s === 'CONCLUÍDO') return 'bg-green-100 text-green-800 border-green-200';
        if (s === 'ATRASADO') return 'bg-red-100 text-red-800 border-red-200';
        return 'bg-slate-100 text-slate-800 border-slate-200';
      };

      // VISTAS
      const renderNavigation = () => (
        <nav className="bg-slate-900 text-white shadow-md sticky top-0 z-50 no-print">
          <div className="max-w-7xl mx-auto px-4 h-16 flex justify-between items-center">
            <div className="flex items-center space-x-3">
              <i className="ph-fill ph-shield-warning text-indigo-400 text-[28px]"></i>
              <span className="font-bold text-lg tracking-tight hidden sm:block">ISO 9001:2015 - REVIMAQ</span>
              <span className="font-bold text-lg tracking-tight sm:hidden">REVIMAQ</span>
            </div>
            <div className="flex items-center space-x-2">
              <button onClick={() => setCurrentView('dashboard')} className={`px-3 py-2 rounded-md text-sm font-medium ${currentView === 'dashboard' ? 'bg-slate-800 text-indigo-400 border-b-2 border-indigo-500' : 'hover:bg-slate-800'}`}><i className="ph ph-chart-bar text-lg"></i> <span className="hidden lg:block">PAINEL</span></button>
              <button onClick={() => setCurrentView('list')} className={`px-3 py-2 rounded-md text-sm font-medium ${currentView === 'list' ? 'bg-slate-800 text-indigo-400 border-b-2 border-indigo-500' : 'hover:bg-slate-800'}`}><i className="ph ph-list-bullets text-lg"></i> <span className="hidden lg:block">CONTROLE (8.7)</span></button>
              <button onClick={() => setCurrentView('rnc')} className={`px-3 py-2 rounded-md text-sm font-medium ${currentView === 'rnc' ? 'bg-slate-800 text-indigo-400 border-b-2 border-indigo-500' : 'hover:bg-slate-800'}`}><i className="ph ph-folder-warning text-lg"></i> <span className="hidden lg:block">RNC (10.2)</span></button>
              <button onClick={() => { setFormData(initialState); setIsEditing(false); setIsRncLocked(false); setCurrentView('form'); }} className="bg-indigo-600 hover:bg-indigo-700 px-4 py-2 rounded-md text-sm font-medium flex items-center space-x-1 shadow-lg ml-2"><i className="ph ph-plus-circle text-lg"></i> <span className="hidden sm:block">LANÇAR</span></button>
            </div>
          </div>
        </nav>
      );

      const renderDashboard = () => (
        <div className="p-6 max-w-7xl mx-auto animate-fade-in no-print">
          <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
            <h2 className="text-2xl font-black text-slate-800 tracking-tight">PAINEL EXECUTIVO QUALIDADE</h2>
            <div className="flex items-center space-x-3 w-full sm:w-auto">
              <button onClick={() => setShowAllRecords(!showAllRecords)} className={`px-4 py-2 text-sm font-medium rounded-lg border transition-colors shadow-sm ${showAllRecords ? 'bg-indigo-50 text-indigo-700 border-indigo-200' : 'bg-white border-slate-300'}`}>{showAllRecords ? 'OCULTAR ENCERRADOS' : 'MOSTRAR TODOS'}</button>
              <input type="text" className="bg-white border border-slate-300 text-sm rounded-lg pl-3 p-2 w-full sm:w-64 shadow-sm" placeholder="BUSCAR..." value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} />
            </div>
          </div>
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-200">
              <div className="flex items-center justify-between"><p className="text-sm font-bold text-slate-400 tracking-wider">TOTAL GERAL</p><i className="ph ph-file-text text-indigo-500 text-3xl opacity-50"></i></div>
              <p className="text-3xl font-black text-slate-800 mt-2">{stats.total}</p>
            </div>
            <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 border-l-4 border-l-red-500">
              <div className="flex items-center justify-between"><p className="text-sm font-bold text-red-500 tracking-wider">ABERTOS</p><i className="ph ph-warning text-red-500 text-3xl opacity-50"></i></div>
              <p className="text-3xl font-black text-slate-800 mt-2">{stats.open}</p>
            </div>
            <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 border-l-4 border-l-yellow-500">
              <div className="flex items-center justify-between"><p className="text-sm font-bold text-yellow-500 tracking-wider">EM TRATATIVA</p><i className="ph ph-clock text-yellow-500 text-3xl opacity-50"></i></div>
              <p className="text-3xl font-black text-slate-800 mt-2">{stats.inProgress}</p>
            </div>
            <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 border-l-4 border-l-green-500">
              <div className="flex items-center justify-between"><p className="text-sm font-bold text-green-500 tracking-wider">ENCERRADOS</p><i className="ph ph-check-circle text-green-500 text-3xl opacity-50"></i></div>
              <p className="text-3xl font-black text-slate-800 mt-2">{stats.closed}</p>
            </div>
          </div>
          <div className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
            <div className="p-5 border-b bg-slate-50/50 font-bold text-slate-700 flex justify-between items-center">
              <div className="flex items-center"><i className="ph ph-clock-counter-clockwise mr-2 text-indigo-500"></i> REGISTROS RECENTES</div>
              <span className="text-xs bg-red-100 text-red-700 px-3 py-1 rounded-full font-black tracking-tighter">{stats.needsRNC} RNCS REQUERIDAS</span>
            </div>
            <div className="overflow-x-auto">
              <table className="w-full text-sm text-left whitespace-nowrap">
                <thead className="text-xs text-slate-400 uppercase bg-slate-50 border-b">
                  <tr><th className="px-6 py-4">RO</th><th className="px-6 py-4">RNC VINCULADA</th><th className="px-6 py-4">ÁREA</th><th className="px-6 py-4">TÍTULO</th><th className="px-6 py-4">STATUS</th><th className="px-6 py-4 text-center">RNC NECESSÁRIA?</th><th className="px-6 py-4 text-center">AÇÕES</th></tr>
                </thead>
                <tbody className="divide-y divide-slate-100">
                  {filteredRecords.slice(0, 10).map((record) => (
                    <tr key={record.idDb} className="hover:bg-slate-50/80 transition-colors">
                      <td className="px-6 py-4 font-black text-slate-700">{record.id}</td>
                      <td className="px-6 py-4"><span className={`font-bold ${record.rncId ? 'text-red-600' : 'text-slate-300 italic text-[10px]'}`}>{record.rncId || 'N/A'}</span></td>
                      <td className="px-6 py-4 font-medium text-slate-500">{record.area}</td>
                      <td className="px-6 py-4 max-w-xs truncate font-bold text-slate-700">{record.titulo}</td>
                      <td className="px-6 py-4"><span className={`px-2.5 py-1 text-[10px] font-black rounded-full border tracking-tighter ${getStatusColor(record.status)}`}>{record.status}</span></td>
                      <td className="px-6 py-4 text-center"><span className={`text-[9px] font-black px-2 py-0.5 rounded border ${record.necessitaRNC === 'SIM' ? 'bg-red-50 text-red-600 border-red-200' : 'bg-slate-50 text-slate-400 border-slate-200'}`}>{record.necessitaRNC}</span></td>
                      <td className="px-6 py-4 text-center">
                        <div className="flex items-center justify-center space-x-2">
                          <button onClick={() => handleEdit(record)} className="p-2 text-slate-400 hover:text-indigo-600 rounded-lg transition-all"><i className="ph ph-pencil-simple text-xl"></i></button>
                          <button onClick={() => handlePrint(record, 'dashboard')} className="p-2 text-slate-400 hover:text-slate-800 rounded-lg transition-all"><i className="ph ph-printer text-xl"></i></button>
                        </div>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      );

      const renderList = () => (
        <div className="p-6 max-w-7xl mx-auto animate-fade-in no-print">
          <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
            <div><h2 className="text-2xl font-black text-slate-800">8.7 CONTROLE DE SAÍDAS NÃO CONFORMES</h2><p className="text-sm text-slate-500">GESTÃO OPERACIONAL DE DESVIOS E CONTENÇÃO.</p></div>
            <div className="flex items-center space-x-3 w-full sm:w-auto">
              <button onClick={() => setShowAllRecords(!showAllRecords)} className={`px-4 py-2 text-sm font-medium rounded-lg border transition-colors shadow-sm ${showAllRecords ? 'bg-indigo-50 text-indigo-700 border-indigo-200' : 'bg-white border-slate-300'}`}>{showAllRecords ? 'OCULTAR ENCERRADOS' : 'MOSTRAR TODOS'}</button>
              <input type="text" className="bg-white border border-slate-300 text-sm rounded-lg pl-3 p-2 w-full sm:w-64 shadow-sm" placeholder="PESQUISAR..." value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} />
            </div>
          </div>
          <div className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
            <div className="overflow-x-auto">
              <table className="w-full text-sm text-left whitespace-nowrap">
                <thead className="text-xs text-slate-400 uppercase bg-slate-50 border-b">
                  <tr><th className="px-6 py-4">RO</th><th className="px-6 py-4">DATA OCORR.</th><th className="px-6 py-4">ÁREA / SETOR</th><th className="px-6 py-4">RESPONSÁVEL DISP.</th><th className="px-6 py-4 text-center">RNC?</th><th className="px-6 py-4">STATUS</th><th className="px-6 py-4 text-center">AÇÕES</th></tr>
                </thead>
                <tbody className="divide-y divide-slate-100">
                  {filteredRecords.map((record) => (
                    <tr key={record.idDb} className="hover:bg-slate-50 transition-colors">
                      <td className="px-6 py-4 font-black text-slate-800">{record.id}</td>
                      <td className="px-6 py-4 text-slate-500">{record.dataOcorrencia}</td>
                      <td className="px-6 py-4 font-bold text-slate-700">{record.area} <span className="text-[10px] text-slate-400 block font-medium">{record.processo}</span></td>
                      <td className="px-6 py-4 font-medium">{record.respDisposicao || '-'}</td>
                      <td className="px-6 py-4 text-center"><span className={`text-[9px] font-black px-2 py-0.5 rounded border ${record.necessitaRNC === 'SIM' ? 'bg-red-50 text-red-600 border-red-200' : 'bg-slate-50 text-slate-400 border-slate-200'}`}>{record.necessitaRNC === 'SIM' ? 'RNC ABERTA' : 'NÃO'}</span></td>
                      <td className="px-6 py-4"><span className={`px-2.5 py-1 text-[10px] font-black rounded-full border tracking-tighter ${getStatusColor(record.status)}`}>{record.status}</span></td>
                      <td className="px-6 py-4 text-center">
                        <div className="flex items-center justify-center space-x-1">
                          <button onClick={() => handleEdit(record)} className="p-2 text-slate-400 hover:text-indigo-600 rounded-lg transition-all"><i className="ph ph-pencil-simple text-xl"></i></button>
                          <button onClick={() => handlePrint(record, 'list')} className="p-2 text-slate-400 hover:text-slate-800 rounded-lg transition-all"><i className="ph ph-printer text-xl"></i></button>
                        </div>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      );

      const renderRNC = () => {
        const filteredRNC = records.filter(r => (r.necessitaRNC || '').toUpperCase() === 'SIM').filter(record => {
          const term = searchTerm.toLowerCase();
          const matchesSearch = (record.rncId || '').toLowerCase().includes(term) || (record.id || '').toLowerCase().includes(term);
          const currentStatus = (record.rncStatusAcao || '').toUpperCase();
          const matchesStatus = showAllRecords ? true : currentStatus !== 'CONCLUÍDO';
          return matchesSearch && matchesStatus;
        });
        return (
          <div className="p-6 max-w-7xl mx-auto animate-fade-in no-print">
            <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
              <div><h2 className="text-2xl font-black text-slate-800">10.2 NÃO CONFORMIDADE E AÇÃO CORRETIVA</h2><p className="text-sm text-slate-500">GESTÃO DE MELHORIAS E ANÁLISE DE CAUSA RAIZ.</p></div>
              <div className="flex items-center space-x-3 w-full sm:w-auto">
                <button onClick={() => setShowAllRecords(!showAllRecords)} className={`px-4 py-2 text-sm font-medium rounded-lg border transition-colors shadow-sm ${showAllRecords ? 'bg-red-50 text-red-700 border-red-200' : 'bg-white border-slate-300'}`}>{showAllRecords ? 'OCULTAR CONCLUÍDOS' : 'MOSTRAR TODOS'}</button>
                <input type="text" className="bg-white border border-slate-300 text-sm rounded-lg pl-3 p-2 w-full sm:w-64 shadow-sm" placeholder="PESQUISAR RNC..." value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} />
              </div>
            </div>
            <div className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden border-t-4 border-t-red-600">
              <div className="overflow-x-auto">
                <table className="w-full text-sm text-left whitespace-nowrap">
                  <thead className="text-xs text-red-400 uppercase bg-red-50/30 border-b">
                    <tr><th className="px-6 py-4">NÚMERO RNC</th><th className="px-6 py-4">RO ORIGEM</th><th className="px-6 py-4">ÁREA</th><th className="px-6 py-4">RISCO POTENCIAL?</th><th className="px-6 py-4">DATA ANÁLISE</th><th className="px-6 py-4">STATUS AÇÃO</th><th className="px-6 py-4 text-center">AÇÕES</th></tr>
                  </thead>
                  <tbody className="divide-y divide-red-50">
                    {filteredRNC.map((record) => (
                      <tr key={record.idDb} className="hover:bg-red-50/50 transition-colors">
                        <td className="px-6 py-4 font-black text-red-600 text-base">{record.rncId}</td>
                        <td className="px-6 py-4 font-bold text-slate-500">{record.id}</td>
                        <td className="px-6 py-4 font-medium text-slate-700">{record.area}</td>
                        <td className="px-6 py-4 text-center"><span className={`px-2 py-0.5 rounded font-black text-[10px] border ${record.rncRiscoPotencial === 'SIM' ? 'bg-red-100 text-red-600 border-red-200' : 'bg-slate-100 text-slate-500'}`}>{record.rncRiscoPotencial}</span></td>
                        <td className="px-6 py-4 font-bold text-slate-600">{record.rncDataRiscos || '-'}</td>
                        <td className="px-6 py-4"><span className={`px-2.5 py-1 text-[10px] font-black rounded-full border tracking-tighter ${getRNCStatusColor(record.rncStatusAcao)}`}>{record.rncStatusAcao || 'PENDENTE'}</span></td>
                        <td className="px-6 py-4 text-center">
                          <div className="flex items-center justify-center space-x-2">
                            <button onClick={() => handleEdit(record)} className="p-2 text-red-400 hover:text-red-700 hover:bg-red-100 rounded-lg transition-all"><i className="ph ph-pencil-simple text-xl"></i></button>
                            <button onClick={() => handlePrint(record, 'rnc')} className="p-2 text-slate-400 hover:text-slate-800 hover:bg-slate-100 rounded-lg transition-all"><i className="ph ph-printer text-xl"></i></button>
                          </div>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        );
      };

      const renderForm = () => (
        <div className="p-6 max-w-5xl mx-auto animate-fade-in pb-20 no-print">
          <div className="mb-8 flex justify-between items-start border-b pb-6">
            <div>
              <h2 className="text-3xl font-black text-slate-800 tracking-tighter">{isEditing ? `EDIÇÃO: ${formData.id}` : 'RELATÓRIO DE OCORRÊNCIA'}</h2>
              <p className="text-slate-500 font-medium">GESTÃO INTEGRADA ISO 9001 • REVIMAQ</p>
            </div>
            <button onClick={() => setCurrentView('list')} className="bg-slate-100 p-2 rounded-xl text-slate-400 hover:text-red-600 hover:bg-red-50 transition-all active:scale-90"><i className="ph ph-x-circle text-4xl"></i></button>
          </div>

          <form onSubmit={handleSubmit} className="space-y-10">
            {/* 1. Identificação */}
            <section className="bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden">
              <div className="bg-slate-800 p-4 font-black text-white flex items-center tracking-widest text-[10px]">
                <span className="bg-indigo-500 text-white w-5 h-5 rounded-md flex items-center justify-center mr-3">01</span>
                IDENTIFICAÇÃO DA ORIGEM
              </div>
              <div className="p-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div>
                  <label className="block text-[10px] font-black text-slate-400 mb-2">EMITIDO POR *</label>
                  <div className="flex space-x-2">
                    <select name="emitidoPor" required value={formData.emitidoPor} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 focus:ring-2 focus:ring-indigo-500 focus:bg-white transition-all">
                      <option value="">SELECIONE...</option>
                      {emitentes.map((e, i) => <option key={i} value={e.nome}>{e.nome}</option>)}
                    </select>
                    <button type="button" onClick={handleAddEmitente} className="bg-indigo-100 text-indigo-700 font-bold px-4 rounded-xl hover:bg-indigo-200 transition-colors" title="ADICIONAR NOVO">+</button>
                    <button type="button" onClick={handleEditEmitente} className="bg-amber-100 text-amber-700 font-bold px-3 rounded-xl hover:bg-amber-200 transition-colors" title="EDITAR"><i className="ph ph-pencil-simple text-lg"></i></button>
                  </div>
                </div>
                <div><label className="block text-[10px] font-black text-slate-400 mb-2">E-MAIL</label><input type="email" name="email" value={formData.email} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 focus:ring-4 focus:ring-indigo-500/10 focus:bg-white transition-all outline-none" /></div>
                <div><label className="block text-[10px] font-black text-slate-400 mb-2">DATA OCORRÊNCIA *</label><input type="date" name="dataOcorrencia" required value={formData.dataOcorrencia} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 font-black" /></div>
                <div><label className="block text-[10px] font-black text-slate-400 mb-2">ORIGEM</label><select name="origem" value={formData.origem} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 font-bold"><option value="PROCESSO INTERNO">PROCESSO INTERNO</option><option value="AUDITORIA INTERNA">AUDITORIA INTERNA</option><option value="AUDITORIA EXTERNA">AUDITORIA EXTERNA</option><option value="RECLAMAÇÃO CLIENTE">RECLAMAÇÃO DE CLIENTE</option><option value="FORNECEDOR">FORNECEDOR</option><option value="INSPEÇÃO">INSPEÇÃO/ENSAIO</option></select></div>
                <div><label className="block text-[10px] font-black text-slate-400 mb-2">REFERÊNCIA</label><input type="text" name="referencia" value={formData.referencia} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 focus:ring-2 focus:ring-indigo-500" /></div>
                <div>
                  <label className="block text-[10px] font-black text-slate-400 mb-2">CLIENTE</label>
                  <div className="flex space-x-2">
                    <select name="cliente" value={formData.cliente} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3">
                      <option value="">SELECIONE...</option>
                      {clientes.map((c, i) => <option key={i} value={c.nome}>{c.nome}</option>)}
                    </select>
                    <button type="button" onClick={handleAddCliente} className="bg-indigo-100 text-indigo-700 font-bold px-4 rounded-xl hover:bg-indigo-200" title="ADICIONAR">+</button>
                    <button type="button" onClick={handleEditCliente} className="bg-amber-100 text-amber-700 font-bold px-3 rounded-xl hover:bg-amber-200"><i className="ph ph-pencil-simple text-lg"></i></button>
                  </div>
                </div>
              </div>
            </section>

            {/* 2. Rastreabilidade */}
            <section className="bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden">
              <div className="bg-slate-100 p-4 font-black text-slate-600 flex items-center tracking-widest text-[10px]">
                <span className="bg-slate-400 text-white w-5 h-5 rounded-md flex items-center justify-center mr-3">02</span>
                RASTREABILIDADE (ONDE OCORREU?)
              </div>
              <div className="p-8 grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                  <label className="block text-[10px] font-black text-slate-400 mb-2">ÁREA / SETOR *</label>
                  <div className="flex space-x-2">
                    <select name="area" required value={formData.area} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 font-bold focus:ring-2 focus:ring-indigo-500">
                      <option value="">SELECIONE...</option>
                      {areas.map((a, i) => <option key={i} value={a.nome}>{a.nome}</option>)}
                    </select>
                    <button type="button" onClick={handleAddArea} className="bg-indigo-100 text-indigo-700 font-bold px-4 rounded-xl hover:bg-indigo-200" title="ADICIONAR">+</button>
                    <button type="button" onClick={handleEditArea} className="bg-amber-100 text-amber-700 font-bold px-3 rounded-xl hover:bg-amber-200"><i className="ph ph-pencil-simple text-lg"></i></button>
                  </div>
                </div>
                <div>
                  <label className="block text-[10px] font-black text-slate-400 mb-2">PROCESSO</label>
                  <div className="flex space-x-2">
                    <select name="processo" value={formData.processo} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 focus:ring-2 focus:ring-indigo-500">
                      <option value="">SELECIONE...</option>
                      {processos.map((p, i) => <option key={i} value={p.nome}>{p.nome}</option>)}
                    </select>
                    <button type="button" onClick={handleAddProcesso} className="bg-indigo-100 text-indigo-700 font-bold px-4 rounded-xl hover:bg-indigo-200" title="ADICIONAR">+</button>
                    <button type="button" onClick={handleEditProcesso} className="bg-amber-100 text-amber-700 font-bold px-3 rounded-xl hover:bg-amber-200"><i className="ph ph-pencil-simple text-lg"></i></button>
                  </div>
                </div>
                <div><label className="block text-[10px] font-black text-slate-400 mb-2">PRODUTO / ITEM</label><input type="text" name="produto" value={formData.produto} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 focus:ring-2 focus:ring-indigo-500" /></div>
              </div>
            </section>

            {/* 3. Descrição */}
            <section className="bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden">
              <div className="bg-slate-100 p-4 font-black text-slate-600 flex items-center tracking-widest text-[10px]">
                <span className="bg-slate-400 text-white w-5 h-5 rounded-md flex items-center justify-center mr-3">03</span>
                DESCRIÇÃO DA NÃO CONFORMIDADE
              </div>
              <div className="p-8 space-y-8">
                <div className="grid grid-cols-1 md:grid-cols-4 gap-8">
                  <div className="md:col-span-3">
                    <label className="block text-[10px] font-black text-slate-400 mb-2">TÍTULO RESUMIDO *</label>
                    <div className="flex space-x-2">
                      <select name="titulo" required value={formData.titulo} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 font-black text-slate-800 focus:ring-2 focus:ring-indigo-500">
                        <option value="">SELECIONE...</option>
                        {titulos.map((t, i) => <option key={i} value={t.nome}>{t.nome}</option>)}
                      </select>
                      <button type="button" onClick={handleAddTitulo} className="bg-indigo-100 text-indigo-700 font-bold px-4 rounded-xl hover:bg-indigo-200" title="ADICIONAR">+</button>
                      <button type="button" onClick={handleEditTitulo} className="bg-amber-100 text-amber-700 font-bold px-3 rounded-xl hover:bg-amber-200"><i className="ph ph-pencil-simple text-lg"></i></button>
                    </div>
                  </div>
                  <div><label className="block text-[10px] font-black text-slate-400 mb-2">PROCEDENTE?</label><select name="procedente" value={formData.procedente} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 font-black text-indigo-600 focus:ring-2 focus:ring-indigo-500"><option value="">SELECIONE...</option><option value="SIM">SIM</option><option value="NÃO">NÃO</option></select></div>
                </div>
                <div><label className="block text-[10px] font-black text-slate-400 mb-2">O QUE OCORREU? (DETALHES) *</label><textarea name="descricao" required rows="3" value={formData.descricao} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-2xl p-4 outline-none focus:ring-2 focus:ring-indigo-500 transition-all"></textarea></div>
                <div><label className="block text-[10px] font-black text-slate-400 mb-2">EFEITO / CONSEQUÊNCIA</label><textarea name="efeito" rows="2" value={formData.efeito} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-2xl p-4 outline-none focus:ring-2 focus:ring-indigo-500 transition-all"></textarea></div>
              </div>
            </section>

            {/* 4. Controle 8.7 - AMARELO */}
            <section className="bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden border-l-[12px] border-l-yellow-400">
              <div className="bg-yellow-50 p-4 font-black text-yellow-700 flex items-center tracking-widest text-[10px]">
                <span className="bg-yellow-400 text-white w-5 h-5 rounded-md flex items-center justify-center mr-3">04</span>
                DISPOSIÇÃO E AÇÃO IMEDIATA (CONTROLE 8.7)
              </div>
              <div className="p-8 space-y-8">
                <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                  <div><label className="block text-[10px] font-black text-slate-400 mb-2">AÇÃO CORRETIVA IMEDIATA (CONTENÇÃO) *</label><textarea name="acaoImediata" required rows="2" value={formData.acaoImediata} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-2xl p-4 outline-none focus:ring-2 focus:ring-yellow-500 transition-all"></textarea></div>
                  <div><label className="block text-[10px] font-black text-slate-400 mb-2">DISPOSIÇÃO APLICADA</label><select name="disposicao" value={formData.disposicao} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 font-black text-slate-700 focus:ring-2 focus:ring-yellow-500"><option value="">SELECIONE...</option><option value="RETRABALHO">RETRABALHO</option><option value="REFUGO/DESCARTE">REFUGO / DESCARTE</option><option value="ACEITE COM CONCESSÃO">ACEITE COM CONCESSÃO</option><option value="DEVOLUÇÃO AO FORNECEDOR">DEVOLUÇÃO AO FORNECEDOR</option><option value="RECLASSIFICAÇÃO">RECLASSIFICAÇÃO</option></select></div>
                </div>
                <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                  <div>
                    <label className="block text-[10px] font-black text-slate-400 mb-2">RESPONSÁVEL DISPOSIÇÃO</label>
                    <div className="flex space-x-2">
                      <select name="respDisposicao" value={formData.respDisposicao} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 font-bold focus:ring-2 focus:ring-yellow-500">
                        <option value="">SELECIONE...</option>
                        {responsaveis.map((r, i) => <option key={i} value={r.nome}>{r.nome}</option>)}
                      </select>
                      <button type="button" onClick={handleAddResponsavel} className="bg-yellow-100 text-yellow-700 font-bold px-4 rounded-xl hover:bg-yellow-200" title="ADICIONAR">+</button>
                      <button type="button" onClick={handleEditResponsavel} className="bg-amber-100 text-amber-700 font-bold px-3 rounded-xl hover:bg-amber-200"><i className="ph ph-pencil-simple text-lg"></i></button>
                    </div>
                  </div>
                  <div><label className="block text-[10px] font-black text-slate-400 mb-2">PRAZO PARA EXECUÇÃO</label><input type="date" name="prazo" value={formData.prazo} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 focus:ring-2 focus:ring-yellow-500" /></div>
                  <div><label className="block text-[10px] font-black text-slate-400 mb-2">CUSTO ESTIMADO (R$)</label><input type="number" step="0.01" name="custo" value={formData.custo} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 font-black text-red-600 focus:ring-2 focus:ring-yellow-500" /></div>
                </div>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-8 border-t border-slate-100 pt-8">
                   <div><label className="block text-[10px] font-black text-slate-400 mb-2">EVIDÊNCIAS FÍSICAS</label><input type="text" name="evidencias" value={formData.evidencias} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 focus:ring-2 focus:ring-yellow-500" /></div>
                   <div><label className="block text-[10px] font-black text-slate-400 mb-2">LINKS EXTERNOS (DOCUMENTOS)</label><input type="text" name="anexos" value={formData.anexos} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 focus:ring-2 focus:ring-yellow-500" /></div>
                </div>
              </div>
            </section>

            {/* 5. Status Geral */}
            <section className="bg-white rounded-3xl shadow-sm border border-slate-200 overflow-hidden">
              <div className="bg-slate-100 p-4 font-black text-slate-600 flex items-center tracking-widest text-[10px]">
                <span className="bg-slate-400 text-white w-5 h-5 rounded-md flex items-center justify-center mr-3">05</span>
                ANÁLISE DE DADOS E ENCERRAMENTO
              </div>
              <div className="p-8 space-y-8">
                <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                   <div className="bg-red-50 p-6 rounded-2xl border-2 border-red-100 flex flex-col justify-center relative">
                     {isEditing && (formData.necessitaRNC || '').toUpperCase() === 'SIM' && (
                        <button type="button" onClick={() => {
                          const pwd = window.prompt("INSIRA A PALAVRA-PASSE PARA DESBLOQUEAR A RNC:");
                          if(pwd === "123456") {
                              setFormData({...formData, necessitaRNC: 'NÃO AVALIADO'});
                              setIsRncLocked(false);
                              alert("CAMPO DESBLOQUEADO!");
                          } else if (pwd !== null) {
                              alert("PALAVRA-PASSE INCORRETA!");
                          }
                        }} className="absolute top-3 right-3 text-red-600 bg-white p-1.5 rounded-lg shadow-sm hover:bg-red-100 transition-colors"><i className="ph ph-lock-key text-lg"></i></button>
                     )}
                     <label className="block text-xs font-black text-red-800 mb-3 tracking-tighter">ABERTURA DE RNC NECESSÁRIA?</label>
                     <select name="necessitaRNC" value={formData.necessitaRNC} onChange={handleInputChange} disabled={isRncLocked} className="w-full bg-white border-red-200 text-sm rounded-xl p-3 font-black text-red-600 shadow-sm outline-none focus:ring-4 focus:ring-red-500/20 transition-all disabled:opacity-60 disabled:cursor-not-allowed">
                       <option value="NÃO AVALIADO">AINDA NÃO AVALIADO</option>
                       <option value="SIM">SIM (GERAR RNC 10.2)</option>
                       <option value="NÃO">NÃO (DESVIO ISOLADO)</option>
                     </select>
                   </div>
                   <div className="md:col-span-2"><label className="block text-[10px] font-black text-slate-400 mb-2">ANÁLISE FINAL / JUSTIFICATIVAS</label><textarea name="analiseSaida" rows="3" value={formData.analiseSaida} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-2xl p-4 outline-none focus:ring-2 focus:ring-indigo-500 transition-all"></textarea></div>
                </div>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-8 pt-8 border-t border-slate-100">
                  <div><label className="block text-[10px] font-black text-slate-400 mb-2">STATUS ATUAL DO REGISTRO</label><select name="status" value={formData.status} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 font-black text-indigo-700 tracking-widest focus:ring-2 focus:ring-indigo-500 transition-all"><option value="ABERTO">ABERTO</option><option value="EM TRATAMENTO">EM TRATAMENTO</option><option value="ENCERRADO">ENCERRADO</option><option value="CANCELADO">CANCELADO</option></select></div>
                  <div><label className="block text-[10px] font-black text-slate-400 mb-2">DATA EFETIVA DE ENCERRAMENTO</label><input type="date" name="dataEncerramento" value={formData.dataEncerramento} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 font-black outline-none focus:ring-2 focus:ring-indigo-500 transition-all" /></div>
                </div>
              </div>
            </section>

            {/* SEÇÃO RNC (ITEM 10.2) COM ISHIKAWA E PLANO DE AÇÃO (VERMELHO) */}
            {(formData.necessitaRNC || '').toUpperCase() === 'SIM' && (
              <section className="bg-red-50 rounded-[40px] shadow-2xl border-[3px] border-red-200 overflow-hidden animate-fade-in relative">
                 <div className="bg-red-600 p-6 font-black text-white flex items-center shadow-lg tracking-[0.2em] text-xs">
                    <i className="ph ph-folder-warning mr-4 text-3xl"></i>
                    TRATAMENTO DE NÃO CONFORMIDADE E AÇÃO CORRETIVA (ITEM 10.2)
                    {formData.rncId && <span className="ml-auto bg-white/20 px-4 py-1 rounded-full font-black tracking-widest">{formData.rncId}</span>}
                 </div>
                 
                 <div className="p-10 space-y-10">
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                       <div className="bg-white p-5 rounded-2xl shadow-sm border border-red-100"><label className="block text-[9px] font-black text-red-400 mb-2 tracking-widest">RISCO POTENCIAL?</label><select name="rncRiscoPotencial" value={formData.rncRiscoPotencial} onChange={handleInputChange} className="w-full border-none text-sm p-1 font-black text-red-600 focus:ring-0"><option value="SIM">SIM</option><option value="NÃO">NÃO</option></select></div>
                       <div className="bg-white p-5 rounded-2xl shadow-sm border border-red-100"><label className="block text-[9px] font-black text-red-400 mb-2 tracking-widest">ATUALIZAR RISCOS/OPORT?</label><select name="rncAtualizarRiscos" value={formData.rncAtualizarRiscos} onChange={handleInputChange} className="w-full border-none text-sm p-1 font-black text-red-600 focus:ring-0"><option value="SIM">SIM</option><option value="NÃO">NÃO</option></select></div>
                       <div className="bg-white p-5 rounded-2xl shadow-sm border border-red-100"><label className="block text-[9px] font-black text-red-400 mb-2 tracking-widest">GESTOR RESPONSÁVEL</label><input type="text" name="rncResponsavelRiscos" value={formData.rncResponsavelRiscos} onChange={handleInputChange} className="w-full border-none text-sm p-1 font-bold focus:ring-0" /></div>
                       <div className="bg-white p-5 rounded-2xl shadow-sm border border-red-100"><label className="block text-[9px] font-black text-red-400 mb-2 tracking-widest">DATA DA ANÁLISE</label><input type="date" name="rncDataRiscos" value={formData.rncDataRiscos} onChange={handleInputChange} className="w-full border-none text-sm p-1 font-black focus:ring-0" /></div>
                    </div>

                    {/* ISHIKAWA 6M */}
                    <div className="bg-white rounded-3xl p-8 shadow-inner border border-red-100">
                       <h4 className="text-sm font-black text-red-700 tracking-widest mb-6 flex items-center border-b pb-4">
                          <i className="ph ph-fish mr-2"></i> ANÁLISE DE CAUSA RAIZ (ISHIKAWA - 6M)
                       </h4>
                       <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                          <div className="space-y-1"><div className="flex justify-between items-end"><label className="text-[10px] font-black text-slate-400 tracking-widest">01. MÉTODO</label><button type="button" onClick={() => copyToCausaRaiz('rncMetodo', '01. MÉTODO')} className="text-[9px] font-bold text-red-500 hover:text-red-700 bg-red-50 px-2 py-1 rounded"> + CAUSA</button></div><textarea name="rncMetodo" value={formData.rncMetodo} onChange={handleInputChange} rows="2" className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-xs outline-none focus:bg-white focus:border-red-400 transition-all"></textarea></div>
                          <div className="space-y-1"><div className="flex justify-between items-end"><label className="text-[10px] font-black text-slate-400 tracking-widest">02. MÁQUINA</label><button type="button" onClick={() => copyToCausaRaiz('rncMaquina', '02. MÁQUINA')} className="text-[9px] font-bold text-red-500 hover:text-red-700 bg-red-50 px-2 py-1 rounded"> + CAUSA</button></div><textarea name="rncMaquina" value={formData.rncMaquina} onChange={handleInputChange} rows="2" className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-xs outline-none focus:bg-white focus:border-red-400 transition-all"></textarea></div>
                          <div className="space-y-1"><div className="flex justify-between items-end"><label className="text-[10px] font-black text-slate-400 tracking-widest">03. MEDIDA</label><button type="button" onClick={() => copyToCausaRaiz('rncMedida', '03. MEDIDA')} className="text-[9px] font-bold text-red-500 hover:text-red-700 bg-red-50 px-2 py-1 rounded"> + CAUSA</button></div><textarea name="rncMedida" value={formData.rncMedida} onChange={handleInputChange} rows="2" className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-xs outline-none focus:bg-white focus:border-red-400 transition-all"></textarea></div>
                          <div className="space-y-1"><div className="flex justify-between items-end"><label className="text-[10px] font-black text-slate-400 tracking-widest">04. MEIO AMBIENTE</label><button type="button" onClick={() => copyToCausaRaiz('rncMeioAmbiente', '04. MEIO AMBIENTE')} className="text-[9px] font-bold text-red-500 hover:text-red-700 bg-red-50 px-2 py-1 rounded"> + CAUSA</button></div><textarea name="rncMeioAmbiente" value={formData.rncMeioAmbiente} onChange={handleInputChange} rows="2" className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-xs outline-none focus:bg-white focus:border-red-400 transition-all"></textarea></div>
                          <div className="space-y-1"><div className="flex justify-between items-end"><label className="text-[10px] font-black text-slate-400 tracking-widest">05. MÃO DE OBRA</label><button type="button" onClick={() => copyToCausaRaiz('rncMaoDeObra', '05. MÃO DE OBRA')} className="text-[9px] font-bold text-red-500 hover:text-red-700 bg-red-50 px-2 py-1 rounded"> + CAUSA</button></div><textarea name="rncMaoDeObra" value={formData.rncMaoDeObra} onChange={handleInputChange} rows="2" className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-xs outline-none focus:bg-white focus:border-red-400 transition-all"></textarea></div>
                          <div className="space-y-1"><div className="flex justify-between items-end"><label className="text-[10px] font-black text-slate-400 tracking-widest">06. MATERIAL</label><button type="button" onClick={() => copyToCausaRaiz('rncMaterial', '06. MATERIAL')} className="text-[9px] font-bold text-red-500 hover:text-red-700 bg-red-50 px-2 py-1 rounded"> + CAUSA</button></div><textarea name="rncMaterial" value={formData.rncMaterial} onChange={handleInputChange} rows="2" className="w-full bg-slate-50 border border-slate-200 rounded-xl p-3 text-xs outline-none focus:bg-white focus:border-red-400 transition-all"></textarea></div>
                       </div>
                    </div>

                    {/* CAUSA RAIZ */}
                    <div className="bg-white rounded-3xl p-8 shadow-inner border-l-[12px] border-red-600">
                       <h4 className="text-sm font-black text-red-700 tracking-widest mb-4">CONCLUSÃO DA ANÁLISE DE CAUSA</h4>
                       <label className="block text-[10px] font-black text-red-800 mb-2 tracking-widest">CAUSA RAIZ IDENTIFICADA *</label>
                       <textarea name="rncCausaRaiz" required rows="3" value={formData.rncCausaRaiz} onChange={handleInputChange} className="w-full bg-red-50 border-2 border-red-200 text-sm rounded-2xl p-4 focus:bg-white focus:border-red-400 outline-none transition-all font-medium" placeholder="QUAL A CAUSA RAIZ DEFINITIVA?"></textarea>
                    </div>

                    {/* PLANO DE AÇÃO CORRETIVA */}
                    <div className="bg-white rounded-3xl p-8 shadow-inner border border-red-100">
                       <h4 className="text-sm font-black text-red-700 tracking-widest mb-6 flex items-center border-b pb-4">
                          <i className="ph ph-list-checks mr-2"></i> PLANO DE AÇÃO CORRETIVA
                       </h4>
                       <div className="space-y-6">
                          <div>
                            <label className="block text-[10px] font-black text-red-800 mb-2 tracking-[0.1em]">AÇÃO CORRETIVA (ELIMINAÇÃO DA CAUSA RAIZ) *</label>
                            <textarea name="rncAcaoCorretiva" required rows="4" value={formData.rncAcaoCorretiva} onChange={handleInputChange} className="w-full bg-slate-50 border-2 border-red-100 text-sm rounded-2xl p-4 focus:bg-white focus:border-red-400 outline-none transition-all font-medium"></textarea>
                          </div>
                          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6">
                             <div className="lg:col-span-2">
                               <label className="block text-[10px] font-black text-red-400 mb-2 tracking-[0.1em]">RESPONSÁVEL</label>
                               <div className="flex space-x-2">
                                 <select name="rncResponsavelAcao" value={formData.rncResponsavelAcao} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 font-bold focus:ring-2 focus:ring-red-400 focus:bg-white transition-all">
                                   <option value="">SELECIONE...</option>
                                   {responsaveis.map((r, i) => <option key={i} value={r.nome}>{r.nome}</option>)}
                                 </select>
                                 <button type="button" onClick={handleAddResponsavelAcao} className="bg-red-100 text-red-700 font-bold px-4 rounded-xl hover:bg-red-200 transition-colors" title="ADICIONAR">+</button>
                                 <button type="button" onClick={handleEditResponsavelAcao} className="bg-amber-100 text-amber-700 font-bold px-3 rounded-xl hover:bg-amber-200 transition-colors" title="EDITAR"><i className="ph ph-pencil-simple text-lg"></i></button>
                               </div>
                             </div>
                             <div>
                               <label className="block text-[10px] font-black text-red-400 mb-2 tracking-[0.1em]">PREVISÃO</label>
                               <input type="date" name="rncPrevisao" value={formData.rncPrevisao} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 font-black" />
                             </div>
                             <div>
                               <label className="block text-[10px] font-black text-red-400 mb-2 tracking-[0.1em]">REALIZADO</label>
                               <input type="date" name="rncRealizado" value={formData.rncRealizado} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 font-black" />
                             </div>
                             <div>
                               <label className="block text-[10px] font-black text-red-400 mb-2 tracking-[0.1em]">STATUS DA AÇÃO</label>
                               <select name="rncStatusAcao" value={formData.rncStatusAcao} onChange={handleInputChange} className="w-full bg-slate-50 border border-slate-200 text-sm rounded-xl p-3 font-black">
                                 <option value="PENDENTE">PENDENTE</option>
                                 <option value="EM ANDAMENTO">EM ANDAMENTO</option>
                                 <option value="CONCLUÍDO">CONCLUÍDO</option>
                                 <option value="ATRASADO">ATRASADO</option>
                               </select>
                             </div>
                          </div>
                       </div>
                    </div>
                 </div>
              </section>
            )}

            <div className="flex justify-end space-x-6 pt-10 border-t border-slate-200">
              <button type="button" onClick={() => setCurrentView('list')} className="px-10 py-4 border-2 border-slate-200 rounded-2xl hover:bg-slate-50 font-black text-slate-400 tracking-widest text-xs">CANCELAR</button>
              <button type="submit" className="px-12 py-4 bg-indigo-600 text-white rounded-2xl hover:bg-indigo-700 font-black shadow-2xl flex items-center tracking-[0.15em] text-xs"><i className="ph ph-floppy-disk mr-3 text-2xl"></i> GRAVAR NO SISTEMA</button>
            </div>
          </form>
        </div>
      );

      const renderPrintReport = () => {
        if (!printData) return null;
        const isRNC = (printData.necessitaRNC || '').toUpperCase() === 'SIM';
        return (
          <div className="print-area max-w-4xl mx-auto p-4 sm:p-8 bg-white my-8 shadow-2xl print:shadow-none print:my-0 text-slate-900 font-sans text-xs">
            <div className="no-print mb-8 flex justify-between items-center bg-slate-100 p-6 border rounded-2xl shadow-sm">
               <button onClick={() => setCurrentView(previousView)} className="px-6 py-2.5 bg-white border border-slate-300 rounded-lg hover:bg-slate-200 flex items-center font-bold text-slate-700 transition-all"><i className="ph ph-arrow-left mr-2"></i> VOLTAR</button>
               <button onClick={() => window.print()} className="px-8 py-2.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 flex items-center font-bold shadow-lg transition-all"><i className="ph ph-printer mr-2 text-xl"></i> IMPRIMIR / PDF</button>
            </div>

            <div className="border-[3px] border-slate-900 bg-white">
               {/* HEADER */}
               <div className="flex justify-between items-center border-b-[3px] border-slate-900 p-5 bg-slate-50/50">
                  <div className="space-y-1">
                     <h1 className="text-2xl font-black uppercase tracking-tighter leading-none">{isRNC ? 'RELATÓRIO DE NÃO CONFORMIDADE (RNC)' : 'RELATÓRIO DE OCORRÊNCIA (RO)'}</h1>
                     <h2 className="text-sm font-bold text-slate-500 uppercase flex items-center"><i className="ph ph-shield-check mr-1.5 text-indigo-600"></i> ISO 9001:2015 - REVIMAQ</h2>
                  </div>
                  <div className="text-right">
                     <div className="text-2xl font-black text-red-600 border-4 border-red-600 px-4 py-1.5 inline-block leading-none shadow-sm">{isRNC ? printData.rncId : printData.id}</div>
                     {isRNC && <p className="text-[8px] font-black text-slate-400 mt-1">VÍNCULO RO: {printData.id}</p>}
                     <p className="text-[10px] font-black mt-2 text-slate-400 tracking-widest">EMISSÃO: {printData.dataOcorrencia}</p>
                  </div>
               </div>

               <div className="border-b-2 border-slate-900">
                  <h3 className="bg-slate-900 text-white p-1 px-4 font-black uppercase text-[9px] tracking-widest">1. IDENTIFICAÇÃO E RASTREABILIDADE</h3>
                  <div className="grid grid-cols-4 border-t border-slate-900">
                     <div className="p-2 border-r border-b border-slate-900 col-span-2"><span className="font-black text-[8px] text-slate-400 block mb-0.5">EMITENTE:</span> <span className="font-bold text-sm">{printData.emitidoPor}</span></div>
                     <div className="p-2 border-r border-b border-slate-900"><span className="font-black text-[8px] text-slate-400 block mb-0.5">ORIGEM:</span> <span className="font-bold">{printData.origem}</span></div>
                     <div className="p-2 border-b border-slate-900"><span className="font-black text-[8px] text-slate-400 block mb-0.5">PROCEDENTE:</span> <span className="font-bold text-indigo-700">{printData.procedente}</span></div>
                     
                     <div className="p-2 border-r border-b border-slate-900 col-span-2"><span className="font-black text-[8px] text-slate-400 block mb-0.5">ÁREA / SETOR:</span> <span className="font-bold text-sm">{printData.area}</span></div>
                     <div className="p-2 border-b border-slate-900 col-span-2"><span className="font-black text-[8px] text-slate-400 block mb-0.5">PROCESSO:</span> <span className="font-bold">{printData.processo || '-'}</span></div>

                     <div className="p-2 border-r border-slate-900 col-span-2"><span className="font-black text-[8px] text-slate-400 block mb-0.5">PRODUTO / REF:</span> <span className="font-bold">{printData.produto || '-'}</span></div>
                     <div className="p-2 col-span-2"><span className="font-black text-[8px] text-slate-400 block mb-0.5">CLIENTE / REF:</span> <span className="font-bold">{printData.cliente || '-'} / {printData.referencia || '-'}</span></div>
                  </div>
               </div>

               <div className="border-b-2 border-slate-900">
                  <h3 className="bg-slate-100 p-1 px-4 font-black uppercase text-[9px] tracking-widest border-b border-slate-900">2. DESCRIÇÃO DA NÃO CONFORMIDADE</h3>
                  <div className="p-4 space-y-4">
                     <div><span className="font-black text-[8px] text-slate-400 block mb-1">TÍTULO:</span><p className="font-black text-base uppercase tracking-tight">{printData.titulo}</p></div>
                     <div><span className="font-black text-[8px] text-slate-400 block mb-1">DESCRIÇÃO:</span><p className="text-sm whitespace-pre-wrap leading-relaxed">{printData.descricao}</p></div>
                     {printData.efeito && <div><span className="font-black text-[8px] text-slate-400 block mb-1">EFEITO:</span><p className="text-xs italic">{printData.efeito}</p></div>}
                  </div>
               </div>

               <div className="border-b-2 border-slate-900">
                  <h3 className="bg-yellow-100 p-1 px-4 font-black uppercase text-[9px] tracking-widest border-b border-slate-900">3. DISPOSIÇÃO E AÇÃO IMEDIATA (CONTROLE 8.7)</h3>
                  <div className="p-4 border-b border-slate-900 bg-white"><span className="font-black text-[8px] text-yellow-700 block mb-1">AÇÃO IMEDIATA:</span><p className="text-sm font-semibold">{printData.acaoImediata}</p></div>
                  <div className="grid grid-cols-4 bg-white divide-x divide-slate-900">
                     <div className="p-2"><span className="font-black text-[8px] text-slate-400 block mb-0.5">DISPOSIÇÃO:</span> <span className="font-black text-xs">{printData.disposicao || '-'}</span></div>
                     <div className="p-2"><span className="font-black text-[8px] text-slate-400 block mb-0.5">RESP:</span> <span className="font-bold">{printData.respDisposicao || '-'}</span></div>
                     <div className="p-2"><span className="font-black text-[8px] text-slate-400 block mb-0.5">PRAZO:</span> <span className="font-bold">{printData.prazo || '-'}</span></div>
                     <div className="p-2"><span className="font-black text-[8px] text-slate-400 block mb-0.5">CUSTO:</span> <span className="font-bold text-red-600">R$ {printData.custo || '0,00'}</span></div>
                  </div>
               </div>

               <div className="border-b-2 border-slate-900">
                  <h3 className="bg-slate-100 p-1 px-4 font-black uppercase text-[9px] tracking-widest border-b border-slate-900">4. ANÁLISE DE DADOS E ENCERRAMENTO</h3>
                  <div className="grid grid-cols-3 divide-x divide-slate-900 border-b border-slate-900">
                     <div className="p-2 bg-red-50/50"><span className="font-black text-[8px] text-red-600 block mb-0.5">ABERTURA RNC?</span> <span className="font-black text-sm">{printData.necessitaRNC}</span></div>
                     <div className="p-2"><span className="font-black text-[8px] text-slate-400 block mb-0.5">STATUS GERAL:</span> <span className="font-black text-sm">{printData.status}</span></div>
                     <div className="p-2"><span className="font-black text-[8px] text-slate-400 block mb-0.5">DATA ENC:</span> <span className="font-bold">{printData.dataEncerramento || '-'}</span></div>
                  </div>
                  <div className="p-3">
                    <span className="font-black text-[8px] text-slate-400 block mb-1">JUSTIFICATIVAS / ANÁLISE FINAL:</span>
                    <p className="text-xs">{printData.analiseSaida || '-'}</p>
                  </div>
               </div>

               {isRNC && (
                  <div className="border-b-2 border-slate-900 bg-red-50/10">
                     <h3 className="bg-red-600 text-white p-1 px-4 font-black uppercase text-[9px] tracking-widest border-b border-slate-900 flex items-center shadow-md">
                        <i className="ph ph-folder-warning mr-2 text-sm"></i>
                        5. TRATAMENTO 10.2 (RNC)
                     </h3>
                     <div className="grid grid-cols-3 divide-x divide-slate-900 border-b border-slate-900">
                        <div className="p-2"><span className="font-black text-[8px] text-red-600 block mb-0.5">RISCO POTENCIAL?</span> <span className="font-black text-xs">{printData.rncRiscoPotencial}</span></div>
                        <div className="p-2"><span className="font-black text-[8px] text-red-600 block mb-0.5">ATUALIZOU RISCOS?</span> <span className="font-black text-xs">{printData.rncAtualizarRiscos}</span></div>
                        <div className="p-2"><span className="font-black text-[8px] text-red-600 block mb-0.5">DATA ANÁLISE:</span> <span className="font-bold text-xs">{printData.rncDataRiscos || '-'}</span></div>
                     </div>
                     
                     <div className="p-4 bg-slate-50 border-b border-slate-900">
                        <span className="font-black text-[8px] text-red-700 block mb-3 underline tracking-widest">ANÁLISE DE CAUSA RAIZ (ISHIKAWA - 6M):</span>
                        <div className="grid grid-cols-2 gap-y-3 gap-x-8">
                           <div className="border-l-2 border-red-200 pl-2"><span className="font-black text-[7px] text-slate-400 block">01. MÉTODO:</span><p className="text-[10px]">{printData.rncMetodo || '-'}</p></div>
                           <div className="border-l-2 border-red-200 pl-2"><span className="font-black text-[7px] text-slate-400 block">04. MEIO AMBIENTE:</span><p className="text-[10px]">{printData.rncMeioAmbiente || '-'}</p></div>
                           <div className="border-l-2 border-red-200 pl-2"><span className="font-black text-[7px] text-slate-400 block">02. MÁQUINA:</span><p className="text-[10px]">{printData.rncMaquina || '-'}</p></div>
                           <div className="border-l-2 border-red-200 pl-2"><span className="font-black text-[7px] text-slate-400 block">05. MÃO DE OBRA:</span><p className="text-[10px]">{printData.rncMaoDeObra || '-'}</p></div>
                           <div className="border-l-2 border-red-200 pl-2"><span className="font-black text-[7px] text-slate-400 block">03. MEDIDA:</span><p className="text-[10px]">{printData.rncMedida || '-'}</p></div>
                           <div className="border-l-2 border-red-200 pl-2"><span className="font-black text-[7px] text-slate-400 block">06. MATERIAL:</span><p className="text-[10px]">{printData.rncMaterial || '-'}</p></div>
                        </div>
                     </div>
                     
                     <div className="p-4 bg-white border-b border-slate-900">
                        <span className="font-black text-[8px] text-red-600 block mb-1.5 underline">CAUSA RAIZ IDENTIFICADA:</span>
                        <p className="text-sm font-bold">{printData.rncCausaRaiz || 'NÃO DEFINIDA.'}</p>
                     </div>

                     <div className="p-4 bg-white min-h-[100px]">
                        <span className="font-black text-[8px] text-red-600 block mb-1.5 underline">PLANO DE AÇÃO CORRETIVA:</span>
                        <p className="text-sm italic whitespace-pre-wrap">{printData.rncAcaoCorretiva || 'PENDENTE DE AÇÃO.'}</p>
                        
                        <div className="grid grid-cols-4 mt-6 border-t pt-4">
                           <div><span className="font-black text-[7px] text-slate-400 block">RESP:</span><p className="text-[9px]">{printData.rncResponsavelAcao || '-'}</p></div>
                           <div><span className="font-black text-[7px] text-slate-400 block">PREV:</span><p className="text-[9px]">{printData.rncPrevisao || '-'}</p></div>
                           <div><span className="font-black text-[7px] text-slate-400 block">REAL:</span><p className="text-[9px]">{printData.rncRealizado || '-'}</p></div>
                           <div><span className="font-black text-[7px] text-slate-400 block">STATUS AÇÃO:</span><p className="text-[9px] font-black text-indigo-700">{printData.rncStatusAcao || '-'}</p></div>
                        </div>
                     </div>
                  </div>
               )}

               <div className="grid grid-cols-2 h-32 divide-x divide-slate-900">
                  <div className="flex flex-col justify-end items-center p-4">
                    <div className="w-56 border-t-2 border-slate-900 pt-2 text-center text-[10px] font-black uppercase">RESPONSÁVEL PELA EMISSÃO</div>
                  </div>
                  <div className="flex flex-col justify-end items-center p-4 bg-slate-50/50">
                    <div className="w-56 border-t-2 border-slate-900 pt-2 text-center text-[10px] font-black uppercase">GESTÃO DA QUALIDADE / SGQ</div>
                  </div>
               </div>
            </div>
            <div className="mt-4 flex justify-between items-center text-[9px] font-black text-slate-400 px-2 border-t pt-2">
              <span>SISTEMA SGQ - REVIMAQ</span>
              <span>PROPRIEDADE DE USO INTERNO</span>
              <span>PÁGINA 01 / 01</span>
            </div>
          </div>
        );
      };

      return (
        <div className="min-h-screen">
          {currentView !== 'print' && renderNavigation()}
          <main>
            {currentView === 'dashboard' && renderDashboard()}
            {currentView === 'list' && renderList()}
            {currentView === 'rnc' && renderRNC()}
            {currentView === 'form' && renderForm()}
            {currentView === 'print' && renderPrintReport()}
          </main>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>